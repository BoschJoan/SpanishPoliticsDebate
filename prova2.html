<!DOCTYPE html>

<meta charset="utf-8">
<link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/pure-min.css">
<link rel="stylesheet" href="https://rawgit.com/tpreusse/radar-chart-d3/master/src/radar-chart.css">

<style>
body {
  padding: 20px;
}
.radar-chart .area {
  fill-opacity: 0.7;
}
.radar-chart.focus .area {
  fill-opacity: 0.3;
}
.radar-chart.focus .area.focused {
  fill-opacity: 0.9;
}
.year.label {
  font: 500 60px "Helvetica Neue";
  fill: #ddd;
}
.overlay {
  fill: none;
  pointer-events: all;
  cursor: ew-resize;
}
</style>

<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="https://rawgit.com/tpreusse/radar-chart-d3/master/src/radar-chart.js"></script>



<span></span>

<script>

var notInterrupted = true;

var data = [
  {
    className: 'Cis',
    axes: [
      {axis: "Paro", value: [2,3,1,3]}, 
      {axis: "Corrupción", value: [1,3,5,2]}, 
      {axis: "Energía", value: [2,1,2,1]},  
      {axis: "Elecciones", value: [3,2,1,1]},  
      {axis: "Otros", value: [2,1,1,3]}
    ]
  },
  {
    className: 'Congreso',
    axes: [
      {axis: "Paro", value: [3,3,2,2]}, 
      {axis: "Corrupción", value: [2,2,2,1]}, 
      {axis: "Energía", value: [0,2,2,2]},  
      {axis: "Elecciones", value: [2,1,2,1]},  
      {axis: "Otros", value: [3,2,2,4]}
    ]
  }
];

function randomDataset(n) {
  return data.map(function(d) {
    return {
      className: d.className,
      axes: d.axes.map(function(axis) {
        return {axis: axis.axis, value: axis.value[n - 1]};
      })
    };
  });
}

var chart = RadarChart.chart();
var cfg = chart.config(); // retrieve default config
var svg = d3.select('body').append('svg')
	.attr('width', cfg.w + cfg.w + 50)
	.attr('height', cfg.h + cfg.h / 4);

var label = svg.append("text")
    .attr("class", "year label")
    .attr("text-anchor", "end")
    .attr("y", cfg.h)
    .attr("x", cfg.w + 50)
    .text(2011);

var box = label.node().getBBox();
	
var overlay = svg.append("rect")
	.attr("class", "overlay")
	.attr("x", box.x)
	.attr("y", box.y)
	.attr("width", box.width)
	.attr("height", box.height)
	.on("mouseover", enableInteraction);
	
function enableInteraction() {
    var yearScale = d3.scale.linear()
        .domain([2011, 2014])
        .range([box.x, box.x + box.width])
        .clamp(true);

    overlay
        .on("mouseover", mouseover)
        .on("mouseout", mouseout)
        .on("mousemove", mousemove)
        .on("touchmove", mousemove);

    function mouseover() {
      label.classed("active", true);
	  notInterrupted = false;
    }

    function mouseout() {
      label.classed("active", false);
    }

	function mousemove() {
		var year = yearScale.invert(d3.mouse(this)[0])-2010;
		render(Math.round(year));
}
  
}

chart.config({w: cfg.w, h: cfg.h, axisText: true, levels: 5, circles: true, maxValue: 5});
cfg = chart.config();
function render(n) {
  var game = svg.selectAll('g.game').data(
    [randomDataset(n)]);
	game.enter().append('g').classed('game', 1);
	game.call(chart);
	
	label.text(2010 + n);
	if (n < 4 && notInterrupted == true) {
		var m = n + 1;
		setTimeout(render,2000,m);
	}
}
render(1);
	

</script>